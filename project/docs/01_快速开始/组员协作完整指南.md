# 组员协作指南 - 完整版

## 📚 文档位置说明

### 根目录文档

| 文档 | 用途 | 阅读顺序 |
|-----|------|---------|
| `README.md` | 项目完整文档（2000+ 行） | 第 3 步 |
| `项目说明.md` | 快速开始（简洁版） | 第 1 步 |

### docs/ 详细文档

```
docs/
├── 01_快速开始/              ← 新手必看
│   ├── QUICKSTART.md                # 3分钟快速开始
│   ├── Docker_Redis配置指南.md       # Redis 详细配置
│   ├── 组员快速上手指南.md           # 团队协作指南
│   ├── 常见问题解答.md              # FAQ
│   ├── 项目文件说明.md              # 文件结构说明
│   └── 最终优化说明.md              # 架构优化记录
│
├── 02_使用指南/              ← 日常使用
│   ├── 配置文件说明.md              # config.yaml 详解
│   ├── 数据字段说明.md              # 17个字段说明
│   └── RSS源配置说明.md             # RSS 配置
│
├── 03_技术文档/              ← 技术深入
│   ├── 系统架构说明.md              # Pipeline 架构
│   └── Redis存储优化方案.md         # Redis 设计
│
└── 04_项目管理/              ← 任务管理
    ├── 代码审查报告_最终版.md        # 代码质量
    └── 组员任务清单.md              # 待办事项
```

### 推荐阅读路径

**新组员（第一次接触项目）**:
```
1. 项目说明.md (根目录)
   ↓ 了解快速开始
2. docs/01_快速开始/组员快速上手指南.md
   ↓ 环境配置 + 运行爬虫
3. docs/01_快速开始/常见问题解答.md
   ↓ 预防常见错误
4. README.md (根目录)
   ↓ 完整技术文档
```

**数据分析同学（需要数据）**:
```
1. docs/02_使用指南/数据字段说明.md
   ↓ 了解数据格式
2. 运行 export_data.bat
   ↓ 导出数据
3. 阅读 data_exports/manual_export/README.md
   ↓ 数据使用说明
```

**后端开发同学（需要理解架构）**:
```
1. docs/03_技术文档/系统架构说明.md
   ↓ Pipeline 架构
2. docs/03_技术文档/Redis存储优化方案.md
   ↓ 存储设计
3. README.md (根目录)
   ↓ 完整技术细节
```

---

## 🎯 角色分工与数据共享

### 1. 数据采集组（爬虫 + Redis）

**任务**:
- 运行爬虫采集数据
- 监控 Redis 队列
- 导出数据给其他组

**操作流程**:
```powershell
# 1. 激活环境
conda activate cs5481

# 2. 启动 Redis
.\start_redis.bat

# 3. 运行爬虫
.\run.bat
# 选择: 2. Run crawler once

# 4. 导出数据（给其他组）
.\export_data.bat
```

**导出的数据位置**:
```
data_exports/manual_export/
├── redis_export_20251020_143052.json      # 完整 JSON
├── redis_export_20251020_143052.jsonl     # 每行一条（推荐）
└── export_metadata_20251020_143052.json   # 元数据
```

---

### 2. 数据清洗组

**需要的数据**:
- 从数据采集组获取导出的 JSON/JSONL 文件

**数据格式**（17个字段）:
```json
{
  "title": "Bitcoin hits new high",
  "content": "Bitcoin surged to...",
  "author": "CryptoNews",
  "created_at": "2025-10-20T14:30:00",
  "url": "https://...",
  "source": "reddit",
  "subreddit": "cryptocurrency",
  "score": 523,
  "num_comments": 145,
  "upvote_ratio": 0.94,
  ...
}
```

**读取数据示例**:
```python
import pandas as pd
import json

# 方法 1: 读取 JSON
with open('data_exports/manual_export/redis_export_xxx.json', 'r', encoding='utf-8') as f:
    data = json.load(f)
df = pd.DataFrame(data)

# 方法 2: 读取 JSONL (推荐,更快)
df = pd.read_json('data_exports/manual_export/redis_export_xxx.jsonl', lines=True)

# 查看数据
print(df.head())
print(df.info())

# 清洗示例
df_clean = df.dropna(subset=['title', 'content'])  # 删除空值
df_clean = df_clean[df_clean['content'].str.len() > 50]  # 过滤短内容
```

**清洗后数据格式**:
- 推荐格式: CSV 或 Parquet
- 保存位置: `data_exports/cleaned/`

---

### 3. 数据分析组

**需要的数据**:
- 从数据清洗组获取清洗后的数据

**分析建议**:
```python
import pandas as pd

# 读取清洗后的数据
df = pd.read_csv('data_exports/cleaned/cleaned_data.csv')

# 情感分析
df['sentiment'] = df['sentiment'].map({
    'bullish': 1,
    'bearish': -1,
    'neutral': 0
})

# 时间序列分析
df['created_at'] = pd.to_datetime(df['created_at'])
df['date'] = df['created_at'].dt.date

# 按数据源统计
source_stats = df.groupby('source').agg({
    'title': 'count',
    'score': 'mean',
    'sentiment': 'mean'
})
print(source_stats)
```

---

### 4. 可视化组

**需要的数据**:
- 从数据分析组获取分析结果
- 或直接从清洗后的数据生成图表

**可视化示例**:
```python
import matplotlib.pyplot as plt
import seaborn as sns

# 数据源分布
plt.figure(figsize=(10, 6))
df['source'].value_counts().plot(kind='bar')
plt.title('Data Distribution by Source')
plt.xlabel('Source')
plt.ylabel('Count')
plt.savefig('outputs/source_distribution.png')

# 情感趋势
sentiment_trend = df.groupby(['date', 'source'])['sentiment'].mean().unstack()
sentiment_trend.plot(figsize=(12, 6))
plt.title('Sentiment Trend by Source')
plt.savefig('outputs/sentiment_trend.png')
```

---

## 🔄 数据流转流程

```
┌─────────────┐
│ 数据采集组   │
│ (爬虫)      │
└──────┬──────┘
       │ Redis 存储
       │
       │ .\export_data.bat
       ↓
┌─────────────────────────────────────┐
│ data_exports/manual_export/         │
│  • redis_export_xxx.json            │
│  • redis_export_xxx.jsonl           │
└──────┬──────────────────────────────┘
       │ 复制文件或共享文件夹
       ↓
┌─────────────┐
│ 数据清洗组   │
│             │
│ pd.read_json()
│ 去重、过滤、标准化
└──────┬──────┘
       │ 保存 CSV/Parquet
       ↓
┌─────────────────────────────────────┐
│ data_exports/cleaned/               │
│  • cleaned_data.csv                 │
└──────┬──────────────────────────────┘
       │
       ├─→ 数据分析组 (统计分析)
       └─→ 可视化组 (图表生成)
```

---

## 📊 数据文件格式说明

### JSON 格式（适合查看、编辑）
```json
[
  {
    "title": "Bitcoin hits $50k",
    "source": "reddit",
    "created_at": "2025-10-20T14:30:00"
  },
  ...
]
```

**优点**:
- ✅ 可读性好
- ✅ 支持嵌套结构

**缺点**:
- ❌ 文件较大
- ❌ 读取速度慢

### JSONL 格式（推荐，适合流式处理）
```json
{"title": "Bitcoin hits $50k", "source": "reddit", "created_at": "2025-10-20T14:30:00"}
{"title": "Ethereum update", "source": "twitter", "created_at": "2025-10-20T14:35:00"}
```

**优点**:
- ✅ 每行一条记录
- ✅ 支持流式读取
- ✅ pandas 直接支持: `pd.read_json(lines=True)`

### CSV 格式（适合清洗后数据）
```csv
title,source,created_at,sentiment
Bitcoin hits $50k,reddit,2025-10-20T14:30:00,bullish
Ethereum update,twitter,2025-10-20T14:35:00,neutral
```

**优点**:
- ✅ Excel 可直接打开
- ✅ 文件小
- ✅ 兼容性好

**缺点**:
- ❌ 不支持嵌套结构

### Parquet 格式（适合大数据）
```python
df.to_parquet('data.parquet')
df = pd.read_parquet('data.parquet')
```

**优点**:
- ✅ 压缩率高（70%）
- ✅ 读取速度快
- ✅ 保留数据类型

---

## 🛠️ 常用工具脚本

### 1. 一键导出数据（给数据分析组）
```powershell
conda activate cs5481
.\export_data.bat
```

**输出**:
- `data_exports/manual_export/redis_export_xxx.json`
- `data_exports/manual_export/redis_export_xxx.jsonl`
- `data_exports/manual_export/export_metadata_xxx.json`

### 2. 查看 Redis 数据（实时）
```powershell
conda activate cs5481
python view_redis_data.py
```

### 3. 验证配置
```powershell
conda activate cs5481
python validate_config.py
```

### 4. 运行测试
```powershell
conda activate cs5481
pytest tests/ -v
```

---

## 💡 团队协作最佳实践

### 1. 文件共享方式

**方式 A: GitHub（推荐）**
```bash
# 数据采集组
git add data_exports/manual_export/
git commit -m "Add exported data 20251020"
git push

# 数据清洗组
git pull
```

**方式 B: 共享文件夹**
- OneDrive / Google Drive
- 直接复制 `data_exports/manual_export/` 文件夹

**方式 C: 压缩包**
```powershell
# 压缩导出数据
Compress-Archive -Path data_exports\manual_export\* -DestinationPath exported_data.zip

# 发送 exported_data.zip 给其他组
```

### 2. 数据命名规范

```
# 原始数据（采集组导出）
redis_export_20251020_143052.jsonl

# 清洗后数据
cleaned_data_20251020.csv

# 分析结果
analysis_result_20251020.csv

# 可视化输出
sentiment_trend_20251020.png
```

### 3. 版本控制

**提交原则**:
- ✅ 代码：每次修改都提交
- ✅ 配置：config.yaml 提交（API 密钥已配置）
- ❌ 数据文件：不提交大文件（使用 .gitignore）
- ✅ 文档：及时更新

**.gitignore 已配置**:
```gitignore
data_exports/*.json
data_exports/*.jsonl
data_exports/*.parquet
logs/*.log
redis_data/
```

---

## 🎓 学习资源

### pandas 数据处理
```python
import pandas as pd

# 读取 JSONL
df = pd.read_json('data.jsonl', lines=True)

# 数据清洗
df = df.dropna()  # 删除空值
df = df.drop_duplicates(subset=['url'])  # 去重

# 数据筛选
df_reddit = df[df['source'] == 'reddit']
df_recent = df[df['created_at'] > '2025-10-01']

# 数据统计
print(df.describe())
print(df['source'].value_counts())

# 保存结果
df.to_csv('cleaned_data.csv', index=False)
```

### 数据可视化
```python
import matplotlib.pyplot as plt
import seaborn as sns

# 设置中文字体
plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

# 柱状图
df['source'].value_counts().plot(kind='bar')
plt.title('数据源分布')
plt.savefig('source_dist.png')

# 折线图
df.groupby('date')['score'].mean().plot()
plt.title('平均评分趋势')
plt.savefig('score_trend.png')
```

---

## 📞 遇到问题？

1. **先查看 FAQ**: `docs/01_快速开始/常见问题解答.md`
2. **搜索文档**: 在 `docs/` 目录搜索关键词
3. **联系组长**: 提供错误信息截图
4. **GitHub Issues**: 提交问题到项目 Issues

---

**更新时间**: 2025-10-20  
**适用角色**: 全体组员
